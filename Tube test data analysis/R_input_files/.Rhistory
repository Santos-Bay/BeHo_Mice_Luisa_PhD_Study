setwd("~/Documents/PhD 2020/BeHo:ZiBA study/Data analysis/Tube test data analysis/R_input_files")
tube_test_wins = read.csv("Mice-full-overview.csv", header = TRUE)
###### TRANSFORM DATAFRAME FOR STATISTICS #######
# placing NA for dead mice (C8 mouse 3065, C16 mouse 3183, C7 mouse 2730, C3 mouse 3083, C1 mouse 4176)
tube_test_wins[76, c(32:45,48:49)] = NA
tube_test_wins[38, c(32:45,48:49)] = NA
tube_test_wins[32, c(32:45,48:49)] = NA
tube_test_wins[14, c(32:45,48:49)] = NA
tube_test_wins[4,c(28:45,47:49)] = NA
#Removing irrelevant columns and saving it into a new df
tube_test_80 <- tube_test_wins [,-c(5,8,10,15,17,21,22,45:50)]
View(tube_test_wins)
View(tube_test_80)
View(tube_test_wins)
#Removing irrelevant columns
tube_test_80 <- tube_test_wins [,-c(5,8,10,39,42:44)]
#Removing irrelevant columns and saving it into a new df
tube_test_80 <- tube_test_wins [,-c(5,8,10,15,17,21,22,45:50)]
#Removing irrelevant columns
tube_test_80 <- tube_test_wins [,-c(5,8,10,39,42:44)]
#Transform the dataframe from a wide to a long format
tube_test_80 <- melt(tube_test_80, id.vars = c("Name","Arrive_weight", "Phenotype", "Crate", "Sex", "Exp_group","Cage.ID"))
#Renaming columns without the many dots
names(tube_test_80)[2] <- "Arrive_weight"
names(tube_test_80)[5] <- "Sex"
names(tube_test_80)[6] <- "Exp_group"
#Removing irrelevant columns and saving it into a new df
tube_test_80 <- tube_test_wins [,-c(5,8,10,39,42:44)]
#Renaming columns without the many dots
names(tube_test_80)[2] <- "Arrive_weight"
names(tube_test_80)[5] <- "Sex"
names(tube_test_80)[6] <- "Exp_group"
#Transform the dataframe from a wide to a long format
tube_test_80 <- melt(tube_test_80, id.vars = c("Name","Arrive_weight", "Phenotype", "Crate", "Sex", "Exp_group","Cage.ID"))
tube_test_wins = read.csv("Mice-full-overview.csv", header = TRUE)
###### TRANSFORM DATAFRAME FOR STATISTICS #######
# placing NA for dead mice (C8 mouse 3065, C16 mouse 3183, C7 mouse 2730, C3 mouse 3083, C1 mouse 4176)
tube_test_wins[76, c(32:45,48:49)] = NA
tube_test_wins[38, c(32:45,48:49)] = NA
tube_test_wins[32, c(32:45,48:49)] = NA
tube_test_wins[14, c(32:45,48:49)] = NA
tube_test_wins[4,c(28:45,47:49)] = NA
#Removing irrelevant columns and saving it into a new df
tube_test_80 <- tube_test_wins [,-c(5,8,10,39,42:44)]
#Renaming columns without the many dots
names(tube_test_80)[2] <- "Arrive_weight"
names(tube_test_80)[5] <- "Sex"
names(tube_test_80)[6] <- "Exp_group"
#Transform the dataframe from a wide to a long format
tube_test_80 <- melt(tube_test_80, id.vars = c("Name","Arrive_weight", "Phenotype", "Crate", "Sex", "Exp_group","Cage.ID"))
library(tidyverse)
library(reshape2)
library(tidyr)
library(effects)
library(ggplot2)
library(sjPlot)
#Transform the dataframe from a wide to a long format
tube_test_80 <- melt(tube_test_80, id.vars = c("Name","Arrive_weight", "Phenotype", "Crate", "Sex", "Exp_group","Cage.ID"))
#Removing irrelevant columns
tube_test_80 <- tube_test_wins [,-c(5,8,10,15:17,21:23, 27, 31, 35:37, 39, 42:50)]
#Renaming columns without the many dots
names(tube_test_80)[2] <- "Arrive_weight"
names(tube_test_80)[5] <- "Sex"
names(tube_test_80)[6] <- "Exp_group"
#Transform the dataframe from a wide to a long format
tube_test_80 <- melt(tube_test_80, id.vars = c("Name","Arrive_weight", "Phenotype", "Crate", "Sex", "Exp_group","Cage.ID"))
#Renaming the columns created by melt()
names(tube_test_80)[8] <- "Treatments"
names(tube_test_80)[9] <- "Wins_per_rep"
names(tube_test_80)[9] <- "Wins_per_rep"
names(tube_test_80)[9] <- "Wins_per_rep"
names(tube_test_80)[9] <- "Wins_per_rep"
names(tube_test_80)[7] <- "Cage_ID"
names(tube_test_80)[4] <- "Crate_ID"
#Add a new column with the replicate info and then rename the rows of column Treatments to only the treatments
Replicates <- c(rep("R1",80), rep("R2",80), rep("R3",80),rep("R4",80),rep(c(rep("R1",80), rep("R2",80), rep("R3",80)),4),rep("R3",80), rep("R4",80), rep("R5",80))
#add the column "Replicates" to the dataframe tube_test_80
tube_test_80 <- cbind(tube_test_80,Replicates)
#Changing the name of the factors created after transforming the dataframe. There are 19 in total corresponding to the no of reps in total.
levels(tube_test_80$Treatments) <- c("OPT","OPT","OPT","OPT","HEAT","HEAT","HEAT","COLD","COLD","COLD","DIET","DIET","DIET","ANTI","ANTI","ANTI","FMT","FMT","FMT")
levels(tube_test_80$Exp_group) <- c("Treatment", "Control") #does the glm or lm model then know how to differ from the experimental and control animals tube test wins? Ask A & O this.
#Move the no of wins column (all of it) to the first column
colnames(tube_test_80)
tube_test_80 <- tube_test_80[, c(9,8,10,1:7)]
#Creating new factors to start statistics. A factor instead of num, chr or int account for variation between the "catagories"
tube_test_80 <- transform(tube_test_80,Replicates=as.factor(Replicates),
Phenotype=as.factor(Phenotype),
Crate=as.factor(Crate_ID),
Sex=as.factor(Sex),
Exp_group=as.factor(Exp_group),
Cage_ID=as.factor(Cage_ID))
#Remove mice that are not among the 40 I'm working with:
#I have mice from cage 3-6 (males) and 10-13 (females)
cages_to_remove <- c("01M","02M","07M","08M","09F","14F","15F","16F")
condition <- tube_test_80$Cage_ID %in% cages_to_remove
tube_test_40 <- tube_test_80[!condition, ]
# Remove rows with missing values (NA) in any column if needing the df like this later
cleaned_tube_test_40 <- drop_na(tube_test_40)
#So far this is the solution:
hist(tube_test_80$Wins_per_rep, breaks=seq(0,4,by=0.2), ylim = c(0,400))
hist(tube_test_40$Wins_per_rep, breaks=seq(0,4,by=0.2), ylim = c(0,200))
?hist()
#So far this is the solution:
pdf("R_plots/Histogram of freq of wins for all 80 mice.pdf", width = 7, height = 10)
par(mar=c(6,4,4,9), xpd=TRUE, mfrow=c(2,1))
hist(tube_test_80$Wins_per_rep, breaks=seq(0,4,by=0.2), ylim = c(0,400), xlab="Dominance wins", main="Histogram showing frequency of wins for all tube tests for all 80 mice")
dev.off()
#So far this is the solution:
pdf("R_plots/Histogram of freq of wins for all 80 mice.pdf", width = 7, height = 10)
hist(tube_test_80$Wins_per_rep, breaks=seq(0,4,by=0.2), ylim = c(0,400), xlab="Dominance wins", main="Histogram showing frequency of wins for all tube tests for all 80 mice")
dev.off()
###### ASKING SIMPLE QS AND ANSWERING THEM ######
#1. What is the hierarchy per cage for each treatments? Is the hierarchy stabile?
#This question is answered March 8th 2022 in the R file "plots march 8th prettier (1)"
avg_wins <- tube_test_wins[,c(1,5, 15, 22, 46:49)]
avg_wins$Cage <- factor(avg_wins$Cage, levels=unique(avg_wins$Cage)) #to keep the order of the cages
avg_wins_by_cage= split(avg_wins, avg_wins$Cage)
#So far this is the solution:
pdf("R_plots/Histogram of freq of wins for all 80 mice.pdf", width = 7, height = 10)
hist_80 <- hist(tube_test_80$Wins_per_rep, breaks=seq(0,4,by=0.2), ylim = c(0,400), xlab="Dominance wins", main="Histogram showing frequency of wins for all tube tests for all 80 mice")
dev.off()
#So far this is the solution:
pdf("R_plots/Histogram of freq of wins for all 80 mice.pdf", width = 7, height = 10)
hist_80 <- hist(tube_test_80$Wins_per_rep, breaks=seq(0,4,by=0.2), ylim = c(0,400), xlab="Dominance wins", main="Histogram showing frequency of wins for all tube tests for all 80 mice")
hist_80
dev.off()
hist_80
hist(tube_test_40$Wins_per_rep, breaks=seq(0,4,by=0.2), ylim = c(0,200),xlab="Dominance wins", main="Histogram showing frequency of wins for all tube tests for the 40 specific mice")
hist_80
#So far this is the solution:
pdf("R_plots/Histogram of freq of wins for all 80 mice.pdf")
hist_80 <- hist(tube_test_80$Wins_per_rep, breaks=seq(0,4,by=0.2), ylim = c(0,400), xlab="Dominance wins", main="Histogram showing frequency of wins for all tube tests for all 80 mice")
hist(tube_test_40$Wins_per_rep, breaks=seq(0,4,by=0.2), ylim = c(0,200),xlab="Dominance wins", main="Histogram showing frequency of wins for all tube tests for the 40 specific mice")
# Violin Plots for all mice across replicates in OPT
library(vioplot)
x1 <- opt_wins$Wins.OPT.R1
x2 <- opt_wins$Wins.OPT.R2
x3 <- opt_wins$Wins.OPT.R3
x4 <- opt_wins$Wins.OPT.R4
vioplot(x1, x2, x3, x4, names=c("R1","R2","R3","R4"),  col=2:5)
opt_wins <- tube_test_wins[,c(1,8,9, 11:17)] #we added TagIDs (col 8) & CageIDs (col 9)
opt_wins <- opt_wins[order(opt_wins$Name),]
x1 <- opt_wins$Wins.OPT.R1
x2 <- opt_wins$Wins.OPT.R2
x3 <- opt_wins$Wins.OPT.R3
x4 <- opt_wins$Wins.OPT.R4
vioplot(x1, x2, x3, x4, names=c("R1","R2","R3","R4"),  col=2:5)
title("Violin Plots of OPT replicates wins")
#2. Is there an overall hierarchy (despite of treatments)? For example one mouse continuously winning
total_avg_wins <- tube_test_wins[,c(1,5,6,50)]
total_avg_wins_40 <- total_avg_wins[-c(1:10,31:45,66:80),] #removing irrelevant rows/cages
#3. Is dominance different between sex?
#Create the basic ggplot object
plot_40_sex <- ggplot(total_avg_wins_40, aes(x = Name, y = Average.rank..wins..for.all.treatments, fill = Cage)) +
geom_bar(stat = "identity") +
labs(x = "Name", y = "Average Wins", title = "Average Wins for All Treatments Cage 3-6M and 10-13F") +
scale_fill_discrete(guide = "none") +  # Remove legend
theme_minimal() +  # Set a transparent background
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~ Sex..from.Cage., ncol = 1)  # Create separate plots for each sex
#show it
plot_40_sex
View(opt_wins)
#5.How's the distribution/pattern of number of wins among replicates? How's the reliability of the tube test replicates?
opt_wi ns <- tube_test_wins[,c(1,8,9, 11:17)] #we added TagIDs (col 8) & CageIDs (col 9)
#5.How's the distribution/pattern of number of wins among replicates? How's the reliability of the tube test replicates?
opt_wins <- tube_test_wins[,c(1,8,9, 11:17)] #we added TagIDs (col 8) & CageIDs (col 9)
opt_wins_40 <- opt_wins[-c(1:10,31:45,66:80),] #removing irrelevant mice
View(opt_wins_40)
# Violin plots for all mice per treatment
avg_wins <- tube_test_wins[,c(1,5, 15, 22, 46:49)]
x1 <- avg_wins$Rank.of.Wins.OPT.Avg
x2 <- avg_wins$Rank.of.Wins.HEAT.Avg
x3 <- avg_wins$Rank.of.wins.COLD.Avg
x4 <- avg_wins$Rank.of.wins.DIET.Avg
x5 <- avg_wins$Rank.of.wins.ANTI.Avg
x6 <- avg_wins$Rank.of.wins.FMTs.3.5.Avg
vioplot(x1, x2, x3, x4, x5, x6, names=c("OPT", "HEAT", "COLD", "DIET", "ANTI", "FMT"),  col=2:7)
title("Violin Plots of average wins per treatment")
# Create the basic ggplot object
#pdf("R_plots/mean_total_win_per_mouse.pdf", width = 10, height = 7)
plot <- ggplot(total_avg_wins, aes(x = Name, y = Average.rank..wins..for.all.treatments, fill = Cage)) +
geom_bar(stat = "identity") +
labs(x = "Name", y = "Average Wins", title = "Average Wins for All Treatments") +
scale_fill_discrete(guide = "none") +  # Remove legend
theme_minimal() +  # Set a transparent background
theme(axis.text.x = element_text(angle = 90, hjust = 1))
#show plot
plot
OPT <- avg_wins$Rank.of.Wins.OPT.Avg
vioplot(OPT, x2, x3, x4, x5, x6, names=c("OPT", "HEAT", "COLD", "DIET", "ANTI", "FMT"),  col=2:7)
vioplot(OPT, HEAT, COLD, DIET, ANTI, FMT)
HEAT <- avg_wins$Rank.of.Wins.HEAT.Avg
HEAT <- avg_wins$Rank.of.Wins.HEAT.Avg
HEAT <- avg_wins$Rank.of.Wins.HEAT.Avg
COLD <- avg_wins$Rank.of.wins.COLD.Avg
DIET <- avg_wins$Rank.of.wins.DIET.Avg
ANTI <- avg_wins$Rank.of.wins.ANTI.Avg
FMT <- avg_wins$Rank.of.wins.FMTs.3.5.Avg
vioplot(OPT, HEAT, COLD, DIET, ANTI, FMT)
vioplot(OPT, HEAT, COLD, DIET, ANTI, FMT,col=2:7)
title("Violin Plots of average wins per treatment")
View(avg_wins)
avg_wins_40 <- avg_wins[-c(1:10,31:45,66:80),]
OPT <- avg_wins_40$Rank.of.Wins.OPT.Avg
HEAT <- avg_wins_40$Rank.of.Wins.HEAT.Avg
COLD <- avg_wins_40$Rank.of.wins.COLD.Avg
DIET <- avg_wins_40$Rank.of.wins.DIET.Avg
ANTI <- avg_wins_40$Rank.of.wins.ANTI.Avg
FMT <- avg_wins_40$Rank.of.wins.FMTs.3.5.Avg
vioplot(OPT, HEAT, COLD, DIET, ANTI, FMT, names=c("OPT", "HEAT", "COLD", "DIET", "ANTI", "FMT"),  col=2:7)
title("Violin Plots of average wins per treatment")
View(avg_wins_40)
title("Violin Plots of 40 mice's mean wins per treatment")
vioplot(OPT, HEAT, COLD, DIET, ANTI, FMT, names=c("OPT", "HEAT", "COLD", "DIET", "ANTI", "FMT"),  col=2:7)
title("Violin Plots of 40 mice's mean wins per treatment")
f_avg_wins <- avg_wins[-c(1:30),] #removing irrelevant cages
OPT <- f_avg_wins$Rank.of.Wins.OPT.Avg
HEAT <- f_avg_wins$Rank.of.Wins.HEAT.Avg
COLD <- f_avg_wins$Rank.of.wins.COLD.Avg
DIET <- f_avg_wins$Rank.of.wins.DIET.Avg
ANTI <- f_avg_wins$Rank.of.wins.ANTI.Avg
FMT <- f_avg_wins$Rank.of.wins.FMTs.3.5.Avg
vioplot(OPT, HEAT, COLD, DIET, ANTI, FMT, names=c("OPT", "HEAT", "COLD", "DIET", "ANTI", "FMT"),  col=2:7)
title("Violin Plots showing the distribution of females mean wins per treatment")
View(avg_wins)
#3. Is dominance different between sex?
avg_wins <- tube_test_wins[,c(1,5, 15, 22, 46:49)]
f_avg_wins <- avg_wins[-c(1:40),] #removing irrelevant cages
OPT <- f_avg_wins$Rank.of.Wins.OPT.Avg
HEAT <- f_avg_wins$Rank.of.Wins.HEAT.Avg
COLD <- f_avg_wins$Rank.of.wins.COLD.Avg
DIET <- f_avg_wins$Rank.of.wins.DIET.Avg
ANTI <- f_avg_wins$Rank.of.wins.ANTI.Avg
FMT <- f_avg_wins$Rank.of.wins.FMTs.3.5.Avg
vioplot(OPT, HEAT, COLD, DIET, ANTI, FMT, names=c("OPT", "HEAT", "COLD", "DIET", "ANTI", "FMT"),  col=2:7)
title("Violin Plots showing the distribution of females mean wins per treatment")
m_avg_wins <- avg_wins[-c(41:80),] #removing irrelevant cages
OPT <- m_avg_wins$Rank.of.Wins.OPT.Avg
HEAT <- m_avg_wins$Rank.of.Wins.HEAT.Avg
COLD <- m_avg_wins$Rank.of.wins.COLD.Avg
DIET <- m_avg_wins$Rank.of.wins.DIET.Avg
ANTI <- m_avg_wins$Rank.of.wins.ANTI.Avg
FMT <- m_avg_wins$Rank.of.wins.FMTs.3.5.Avg
vioplot(OPT, HEAT, COLD, DIET, ANTI, FMT, names=c("OPT", "HEAT", "COLD", "DIET", "ANTI", "FMT"),  col=2:7)
title("Violin Plots showing the distribution of males mean wins per treatment")
View(m_avg_wins)
m_avg_wins_20 <- avg_wins[c(11:30),] #keeping relevant cages
View(m_avg_wins_20)
View(m_avg_wins_20)
View(avg_wins)
f_avg_wins_20 <- avg_wins[c(46:65),] #keeping relevant female cages
View(f_avg_wins_20)
OPT_m <- m_avg_wins$Rank.of.Wins.OPT.Avg
OPT_f <- f_avg_wins$Rank.of.Wins.OPT.Avg
HEAT_m <- m_avg_wins$Rank.of.Wins.HEAT.Avg
HEAT_f <- f_avg_wins$Rank.of.Wins.HEAT.Avg
COLD_m <- m_avg_wins$Rank.of.wins.COLD.Avg
COLD_f <- f_avg_wins$Rank.of.wins.COLD.Avg
DIET_m <- m_avg_wins$Rank.of.wins.DIET.Avg
DIET_f <- f_avg_wins$Rank.of.wins.DIET.Avg
ANTI_m <- m_avg_wins$Rank.of.wins.ANTI.Avg
ANTI_f <- f_avg_wins$Rank.of.wins.ANTI.Avg
FMT_m <- m_avg_wins$Rank.of.wins.FMTs.3.5.Avg
FMT_f <- f_avg_wins$Rank.of.wins.FMTs.3.5.Avg
vioplot(OPT_m,OPT_f,HEAT_m,HEAT_f,COLD_m,COLD_f,DIET_m,DIET_f,ANTI_m,ANTI_f,FMT_m,FMT_f,names=c("OPT male", "OPT female","HEAT male","HEAT female","COLD male","COLD female","DIET male","DIET female","ANTI male","ANTI female","FMT male","FMT female"),  col=1:12)
title("Violin Plots showing the distribution of males' and females' mean wins per treatment")
vioplot(OPT_m,OPT_f,HEAT_m,HEAT_f,COLD_m,COLD_f,DIET_m,DIET_f,ANTI_m,ANTI_f,FMT_m,FMT_f,names=c("OPT male", "OPT female","HEAT male","HEAT female","COLD male","COLD female","DIET male","DIET female","ANTI male","ANTI female","FMT male","FMT female"),  col=2:13)
title("Violin Plots showing the distribution of males' and females' mean wins per treatment")
vioplot(OPT_m,OPT_f,HEAT_m,HEAT_f,COLD_m,COLD_f,DIET_m,DIET_f,ANTI_m,ANTI_f,FMT_m,FMT_f,names=c("OPT male", "OPT female","HEAT male","HEAT female","COLD male","COLD female","DIET male","DIET female","ANTI male","ANTI female","FMT male","FMT female"))
title("Violin Plots showing the distribution of males' and females' mean wins per treatment")
tube_test_wins_raw = read.csv("Mice-full-overview.csv", header = TRUE)
tube_test_wins_raw <- tube_test_wins_raw[order(tube_test_wins_raw$Name),]
plotting_all <- tube_test_wins_raw[,c(1,9,15,22,46:50)]
plot(plotting_all)
View(plotting_all)
